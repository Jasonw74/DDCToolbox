function mygroupdelayTest()
fs = 48000;
sos=[0.96823922173847887 -1.8182229135837229 0.87926813641585599 1.0 -1.8182229135837229 0.84750735815433487
1.047604636642999 -1.826943823146232 0.84411894754576988 1.0 -1.826943823146232 0.89172358418876918
1.00355664309503 -1.5009872735843259 0.70150655536542084 1.0 -1.5009872735843259 0.70506319846045096
1.053165461779932 -1.400120027860374 0.71164720964135242 1.0 -1.400120027860374 0.76481267142128395
0.90202762913297285 -0.92125397048107704 0.75359186072410544 1.0 -0.92125397048107704 0.65561948985707841
1.056557149093897 -0.81211763406773607 0.77961377733339232 1.0 -0.81211763406773607 0.83617092642728974
0.9378884259697351 -0.4394407889121198 0.75998040257050237 1.0 -0.4394407889121198 0.69786882854023746
1.160127330026316 0.49019147538316732 0.20771674198158979 1.0 0.49019147538316732 0.36784407200790592];
% fvtool(sos)
dataPt = 65536;
grpdelay(sos,dataPt);
% plot(w,gd)
hold on
[m,n]=size(sos);
newGd = zeros(dataPt,1);
for idx = 1 : m
    newGd = newGd + myGD(sos(idx,:),fs,dataPt);
end
plot(linspace(0,1,dataPt),newGd)
end
function newGD = myGD(iirfilter,fs,dataPt)
centreFreq = linspace(0,fs/2,dataPt)';
Arg = pi .* centreFreq ./ (fs .* 0.5);
cw = cos(Arg);
cw2 = cos(2.0 .* Arg);
sw = sin(Arg);
sw2 = sin(2.0 .* Arg);
b1 = iirfilter(1); b2 = iirfilter(2); b3 = iirfilter(3);
u = b1 .* sw2 + b2 .* sw;
v = b1 .* cw2 + b2 .* cw + b3;
du = 2.0 .* b1.*cw2 + b2 .* cw;
dv = -(2.0 .* b1.*sw2 + b2 .* sw);
u2v2 = (b1.*b1) + (b2.*b2) + (b3.*b3) + 2.0 .* (b1.*b2 + b2 .* b3).*cw + 2.0 .* (b1.*b3).*cw2;
gdB = (2.0 - (v.*du - u .* dv) ./ u2v2);
b2 = iirfilter(5);b3 = iirfilter(6);
u = sw2 + b2 .* sw;
v = cw2 + b2 .* cw + b3;
du = 2.0 .* cw2 + b2 .* cw;
dv = -(2.0 .* sw2 + b2 .* sw);
u2v2 = 1.0 + (b2.*b2) + (b3.*b3) + 2.0 .* (b2 + b2 .* b3).*cw + 2.0 .* b3.*cw2;
newGD=gdB - (2.0 - (v.*du - u .* dv) ./ u2v2);
end